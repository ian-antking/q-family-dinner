{"version":3,"sources":["../../../src/components/modal/modal.js"],"names":["KEYCODES","ESCAPE","Modal","portalElement","state","getDocument","props","document","handleKeydown","e","keyCode","show","onClose","closeOnEsc","d","createElement","setAttribute","body","appendChild","addEventListener","setState","removeEventListener","remove","closeOnBlur","className","children","isCard","React","Children","only","type","toString","indexOf","showClose","cloneElement","ReactDOM","createPortal","PureComponent","Content","ModalContent","Card","ModalCard","propTypes","PropTypes","bool","isRequired","func","node","object","string","defaultProps"],"mappings":"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","file":"modal.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport ModalContent from './components/content';\nimport ModalCard from './components/card';\n\nconst KEYCODES = {\n  ESCAPE: 27,\n};\n\nexport default class Modal extends PureComponent {\n  static Content = ModalContent\n\n  static Card = ModalCard\n\n  portalElement = null;\n\n  static propTypes = {\n    show: PropTypes.bool.isRequired,\n    onClose: PropTypes.func.isRequired,\n    closeOnEsc: PropTypes.bool,\n    closeOnBlur: PropTypes.bool,\n    showClose: PropTypes.bool,\n    children: PropTypes.node.isRequired,\n    document: PropTypes.object,\n    className: PropTypes.string,\n  }\n\n  static defaultProps = {\n    closeOnEsc: true,\n    showClose: true,\n    closeOnBlur: false,\n    className: '',\n    // Expose mount point for testing\n    document: null,\n  }\n\n  state = {};\n\n  componentDidMount() {\n    const { closeOnEsc } = this.props;\n\n    const d = this.getDocument();\n    this.portalElement = d.createElement('div');\n    this.portalElement.setAttribute('class', 'modal-container');\n    d.body.appendChild(this.portalElement);\n    if (closeOnEsc) {\n      d.addEventListener('keydown', this.handleKeydown);\n    }\n    // eslint-disable-next-line\n    this.setState({ d });\n  }\n\n  componentWillUnmount() {\n    const { d } = this.state;\n    const { closeOnEsc } = this.props;\n    if (closeOnEsc) {\n      d.removeEventListener('keydown', this.handleKeydown);\n    }\n    this.portalElement.remove();\n  }\n\n  getDocument = () => {\n    if (this.props.document) {\n      return this.props.document;\n    }\n\n    if (typeof document !== 'undefined') {\n      return document;\n    }\n\n    return null;\n  }\n\n  handleKeydown = (e) => {\n    if (e.keyCode === KEYCODES.ESCAPE && this.props.show) {\n      this.props.onClose();\n    }\n  }\n\n  render() {\n    const { closeOnBlur, show, className } = this.props;\n    if (!this.getDocument() || !this.portalElement || !show) {\n      return null;\n    }\n    let { children } = this.props;\n    let isCard;\n    try {\n      isCard = React.Children.only(children).type.toString().indexOf('ModalCard') !== -1;\n    } catch (e) {\n      isCard = false;\n    }\n\n    const showClose = !isCard && this.props.showClose;\n\n    if (isCard) {\n      children = React.cloneElement(children, {\n        onClose: this.props.onClose,\n      });\n    }\n\n    return ReactDOM.createPortal(\n      <div className={classnames('modal', className, {\n        'is-active': show,\n      })}\n      >\n        <div role=\"presentation\" className=\"modal-background\" onClick={closeOnBlur ? this.props.onClose : null} />\n        {children}\n        {\n          showClose\n          && <button type=\"button\" onClick={this.props.onClose} className=\"modal-close is-large\" aria-label=\"close\" />}\n      </div>,\n      this.portalElement,\n    );\n  }\n}\n"]}